#################################################
# iOS
#################################################


job-ios-upload:

  stage: deploy
  tags: [ "deploy" ]

  only:
    variables:
      - $DEPLOY_RUN_IOS
      - $NIGHTLY_MASTER

  dependencies:
    - job-ios-xcode

  script:

    #using rsync with following options(verbose, keeping symbolic links, and copy recursively)
    - rsync -rlv build-ios/docs/* $DEPLOY_SERVER:$DEPLOY_SNAPSHOTS_ROOT_DIRECTORY/docs/liblinphone/swift

    - scp build-ios/linphone-sdk-*.zip $DEPLOY_SERVER:$DEPLOY_SNAPSHOTS_ROOT_DIRECTORY/ios/
    - pod repo remove linphone-sdk || true
    - pod repo add linphone-sdk git@gitlab.linphone.org:BC/public/podspec.git
    - pod repo push linphone-sdk build-ios/linphone-sdk.podspec --skip-import-validation --verbose
    - pod repo remove linphone-sdk

#################################################
# Android
#################################################
