###############################################################################
# Dockerfile used to make gitlab.linphone.org:4567/bc/public/linphone-sdk/bc-dev-debian13-test-liblinphone:20251103_update_setuptools
###############################################################################

ARG FROM_IMAGE_TAG=20251103_update_setuptools
FROM gitlab.linphone.org:4567/bc/public/linphone-sdk/bc-dev-debian13:$FROM_IMAGE_TAG

MAINTAINER Andrea Gianarda <andrea.gianarda@belledonne-communications.com>

# Install mediastreamer test dependencies
RUN sudo apt-get update && sudo apt-get install -y alsa-utils pulseaudio

# Install Microsoft openJDK 21 for the java wrapper tester
RUN sudo apt-get update && sudo apt-get install -y openjdk-21-jdk

ENV JAVA_HOME=/usr/lib/jvm/java-21-openjdk-amd64/

# Install other liblinphone java wrapper tester dependencies
RUN sudo apt-get update && sudo apt-get install -y unzip

# Getting dependencies to run tests headlessly
RUN sudo apt-get update && sudo apt-get install -y xvfb
#failing, need to find a workaround
#RUN modprobe snd-dummy

# TODO install debuginfo

CMD bash
